<!doctype html>
<html lang="vi">
<head>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Quiz APP CENTER </title>
  <link rel="icon" href="icon-192.png">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="style.css">

  <!-- ğŸš€ Ã‰p táº£i sáºµn 6 file Ä‘á» + 2 Ä‘á» thá»±c hÃ nh -->
  <script>
    const quizFiles = [
      "questions.js","questions2.js","questions3.js",
      "questions4.js","questions5.js","questions6.js","questions7.js","questions8.js","questions9.js",
      "practice1.js","practice2.js","practice3.js","practice4.js","practice1_g1.js","practice2_g1.js","practice3_g1.js","practice4_g1.js"
    ];
    quizFiles.forEach(f => fetch(f).catch(()=>{}));
  </script>

  <script type="module" src="firebase.js"></script>
</head>

<body class="mono">
  <!-- ğŸ” Kiá»ƒm tra Ä‘Äƒng nháº­p -->
<script type="module">
    import { auth, logout } from "./firebase.js";
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    // Khá»Ÿi táº¡o Firestore Ä‘á»ƒ kiá»ƒm tra dá»¯ liá»‡u
    const db = getFirestore();

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        console.warn("âš ï¸ ChÆ°a Ä‘Äƒng nháº­p, quay vá» login...");
        location.href = "login.html";
      } else {
        console.log("âœ… ÄÃ£ Ä‘Äƒng nháº­p:", user.email);

        // --- Báº®T Äáº¦U: LOGIC Báº¢O Vá»† 1 THIáº¾T Bá»Š ---
        try {
            const userDocRef = doc(db, "users", user.uid);
            const userSnap = await getDoc(userDocRef);

            if (userSnap.exists()) {
                const data = userSnap.data();
                // Láº¥y ID mÃ¡y hiá»‡n táº¡i tá»« bá»™ nhá»›
                const currentDeviceId = localStorage.getItem('my_device_id');
                const devices = data.devices || {};

                // Äiá»u kiá»‡n cháº·n:
                // 1. MÃ¡y nÃ y KHÃ”NG náº±m trong danh sÃ¡ch Ä‘Ã£ lÆ°u (devices)
                // 2. VÃ€ TÃ i khoáº£n Ä‘Ã£ Ä‘á»§ (hoáº·c quÃ¡) 1 thiáº¿t bá»‹ (device_count >= 1)
                if (!devices[currentDeviceId] && (data.device_count >= 1)) {
                    alert("ğŸš« Cáº¢NH BÃO Báº¢O Máº¬T\n\nTÃ i khoáº£n nÃ y chá»‰ Ä‘Æ°á»£c phÃ©p sá»­ dá»¥ng trÃªn 1 thiáº¿t bá»‹ duy nháº¥t.\nBáº¡n Ä‘ang truy cáº­p tá»« thiáº¿t bá»‹ láº¡.");
                    
                    await signOut(auth); // ÄÄƒng xuáº¥t ngay láº­p tá»©c
                    window.location.href = "login.html"; // ÄÃ¡ vá» trang Ä‘Äƒng nháº­p
                }
            }
        } catch (error) {
            console.error("Lá»—i kiá»ƒm tra thiáº¿t bá»‹:", error);
        }
        // --- Káº¾T THÃšC LOGIC Báº¢O Vá»† ---
      }
    });

    window.logout = logout;
  </script>

<header class="header">
  <div class="brand">
    <img src="icon-192.png" alt="H" class="logo">
    <div class="titles">
      <div class="brand-name">Quiz APP</div>
      <div class="subtitle">Trung tÃ¢m nháº­t ngá»¯ Ä‘á»“ng hÃ nh vÃ  phÃ¡t triá»ƒn 
    </div>
  </div>
  
</header>

<!-- ============================
     ğŸ¥ VIDEO GIáº¢NG Dáº Y
============================ -->
<div class="video-section">
  <h3>ğŸ¥ Video giáº£i Ä‘á» lÃ½ thuyáº¿t chung</h3>
  <div class="video-link">
    <a href="https://drive.google.com/file/d/1pl9RlHkuC-D0YzX4zTw41aE-9_p6ZaJ1/preview" 
       target="_blank" rel="noopener noreferrer"
       class="video-btn">â–¶ï¸ Xem video</a>
  </div>
</div>

<div class="video-section">
  <h3>ğŸ¥ Video giáº£i Ä‘á» lÃ½ thuyáº¿t chung</h3>
  <div class="video-link">
    <a href="https://drive.google.com/file/d/1eTkqleEcCfyMb8GNI7voh6p9hdJwSqoO/preview" 
       target="_blank" rel="noopener noreferrer"
       class="video-btn">â–¶ï¸ Xem video</a>
  </div>
</div>

  <div class="video-section">
  <h3>ğŸ¥ Video giáº£i Ä‘á» thá»±c hÃ nh nhÃ³m 1</h3>
  <div class="video-link">
    <a href="https://drive.google.com/file/d/1h8wyAfDmRlrgixBKTIgVB32bR2kPtjcA/preview" 
       target="_blank" rel="noopener noreferrer"
       class="video-btn">â–¶ï¸ Xem video</a>
  </div>
</div>
  
<div class="video-section">
  <h3>ğŸ¥ Video giáº£i Ä‘á» thá»±c hÃ nh nhÃ³m 2</h3>
  <div class="video-link">
    <a href="https://drive.google.com/file/d/14-bKR9jRiHn4OdBH2MQ1tU23b8i1VUSE/preview" 
       target="_blank" rel="noopener noreferrer"
       class="video-btn">â–¶ï¸ Xem video</a>
  </div>
</div>

<!-- ============================
     ğŸ“˜ DANH SÃCH Äá»€ THI
============================ -->
<main class="container">
  <div class="card">
    <h2>Chá»n Ä‘á» thi lÃ½ thuyáº¿t chung</h2>
    <ul id="exam-list" class="exam-list">
      <li><a href="exam.html?set=1">LÃ½ thuyáº¿t chung â€“ (å•1ã€œå•30)</a></li>
      <li><a href="exam.html?set=2">LÃ½ thuyáº¿t chung â€“ (å•31ã€œå•60)</a></li>
      <li><a href="exam.html?set=3">LÃ½ thuyáº¿t chung â€“ (å•61ã€œå•90)</a></li>
      <li><a href="exam.html?set=4">LÃ½ thuyáº¿t chung â€“ (å•91ã€œå•120)</a></li>
      <li><a href="exam.html?set=5">LÃ½ thuyáº¿t chung â€“ (å•121ã€œå•150)</a></li>
      <li><a href="exam.html?set=6">LÃ½ thuyáº¿t chung â€“ (å•151ã€œå•180)</a></li>
      <li><a href="exam.html?set=7">ğŸ‘‰ Nhá»¯ng cÃ¢u lÃ½ thuyáº¿t hay thi pháº§n 1</a></li>
      <li><a href="exam.html?set=8">ğŸ‘‰ Nhá»¯ng cÃ¢u lÃ½ thuyáº¿t hay thi pháº§n 2</a></li>
      <li><a href="exam.html?set=9">ğŸ‘‰ CÃ¢u há»i cáº­p nháº­t</a></li>
      <li><a href="exam.html?set=randomExam" style="font-weight:bold;color:#1e40af;">
        ğŸ² Äá» thi thá»­ lÃ½ thuyáº¿t chung Ä‘áº£o ngáº«u nhiÃªn
      </a></li>
    </ul>
  </div>
 <!-- ========================= -->
  <!-- âœ… KHU Äá»€ THá»°C HÃ€NH NHÃ“M 1 -->
  <!-- ========================= -->
  <div class="card">
    <h2>ğŸ§° Äá» thá»±c hÃ nh nhÃ³m 1</h2>
    <ul class="exam-list">
      <li><a href="exam.html?practice=g1_1">Thá»±c hÃ nh nhÃ³m 1 â€“ (å•1ã€œå•30)</a></li>
      <li><a href="exam.html?practice=g1_2">Thá»±c hÃ nh nhÃ³m 1 â€“ (å•31ã€œå•60)</a></li>
      <li><a href="exam.html?practice=g1_3">Thá»±c hÃ nh nhÃ³m 1 â€“ (å•61ã€œå•90)</a></li>
      <li><a href="exam.html?practice=g1_4">Thá»±c hÃ nh nhÃ³m 1 â€“ (å•91ã€œå•132)</a></li>
      <li><a href="exam.html?practice=g1_random" style="font-weight:bold;color:#1e40af;">ğŸ² Äá» thi thá»­ Ä‘áº£o ngáº«u nhiÃªn 40 cÃ¢u thá»±c hÃ nh nhÃ³m 1</a></li>
    </ul>
  </div>
  <!-- ========================= -->
  <!-- âœ… KHU Äá»€ THá»°C HÃ€NH NHÃ“M 2 -->
  <!-- ========================= -->
  <div class="card">
    <h2>ğŸ§° Äá» thá»±c hÃ nh nhÃ³m 2</h2>
    <ul class="exam-list">
      <li><a href="exam.html?practice=g2_1">Thá»±c hÃ nh nhÃ³m 2 â€“ (å•1ã€œå•30)</a></li>
      <li><a href="exam.html?practice=g2_2">Thá»±c hÃ nh nhÃ³m 2 â€“ (å•31ã€œå•60)</a></li>
      <li><a href="exam.html?practice=g2_3">Thá»±c hÃ nh nhÃ³m 2 â€“ (å•61ã€œå•90)</a></li>
      <li><a href="exam.html?practice=g2_4">Thá»±c hÃ nh nhÃ³m 2 â€“ (å•91ã€œå•130)</a></li>
       <li><a href="exam.html?practice=g2_random" style="font-weight:bold;color:#1e40af;">ğŸ² Äá» thi thá»­ Ä‘áº£o ngáº«u nhiÃªn 40 cÃ¢u thá»±c hÃ nh nhÃ³m 2</a></li>
    </ul>
  </div>
</main>

<footer class="footer">Â© 2025 â€¢ Quiz APP  CENTER</footer>

<!-- ğŸ’… Style bá»• sung -->
<style>
.logout-btn {
  background:#ef4444;
  color:white;
  border:none;
  padding:6px 12px;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
}
.logout-btn:hover { background:#dc2626; }

.video-section {
  background: #fff;
  margin: 16px;
  padding: 16px;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  text-align: center;
}

.video-btn {
  display: inline-block;
  background: #1e40af;
  color: white;
  padding: 10px 20px;
  border-radius: 8px;
  font-weight: bold;
  text-decoration: none;
  transition: 0.2s;
}
.video-btn:hover { background: #2563eb; }

.exam-list li { list-style:none; margin:8px 0; }
.exam-list a {
  display:block;
  background:#f8fafc;
  border:1px solid #cbd5e1;
  padding:10px 14px;
  border-radius:8px;
  color:#1e293b;
  text-decoration:none;
  transition:.2s;
}
.exam-list a:hover { background:#e0e7ff; color:#1e40af; }
</style>

</body>
</html>
